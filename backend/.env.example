# For local Docker: docker compose -f docker/docker-compose.yml up -d (PostgreSQL on 5433, Redis on 6380)
ENVIRONMENT=dev
DATABASE_URL=postgresql+asyncpg://agro:agro@localhost:5433/agro_marketplace
REDIS_URL=redis://localhost:6380/0
JWT_SECRET=change-me-to-random-secret-in-production
STAFF_JWT_SECRET=
JWT_ALGORITHM=HS256
# DEMO_AUTH_ENABLED must be false in production. Do not use with admin-capable credentials.
DEMO_AUTH_ENABLED=false
# Demo login rate limit (per IP) to prevent brute-force
DEMO_LOGIN_RATE_LIMIT_PER_IP=10
DEMO_LOGIN_RATE_LIMIT_WINDOW_SECONDS=300
JWT_ACCESS_EXPIRE_MINUTES=30
OTP_EXPIRE_MINUTES=10
# OTP rate limit: max requests per phone and per IP per 15 min
OTP_RATE_LIMIT_PER_PHONE=3
OTP_RATE_LIMIT_WINDOW_SECONDS=900
OTP_RATE_LIMIT_PER_IP=10
OTP_VERIFY_RATE_LIMIT_PER_PHONE=5
OTP_VERIFY_RATE_LIMIT_PER_IP=15
OTP_VERIFY_RATE_LIMIT_WINDOW_SECONDS=900
OTP_VERIFY_MAX_ATTEMPTS=5
OTP_CODE_SECRET=
SMS_API_URL=
SMS_API_KEY=
WEBHOOK_1C_API_KEY=
# BIN lookup (Adata.kz). Optional: leave empty to allow manual company data entry only.
ADATA_API_KEY=
ADATA_BIN_LOOKUP_URL=https://api.adata.kz/v1/bin
OPENAI_API_KEY=
LLM_FEATURES_ENABLED=true
# Optional: default model for chat and tools (e.g. gpt-4o)
OPENAI_MODEL=gpt-4o
# Optional: chat-only model (empty = use OPENAI_MODEL)
OPENAI_CHAT_MODEL=
# Optional: tool model for suggest/maintenance/compatibility/parser (empty = use OPENAI_MODEL, e.g. gpt-4o-mini)
OPENAI_TOOL_MODEL=
OPENAI_CHAT_MAX_TOKENS=500
OPENAI_TIMEOUT_SECONDS=60
CACHE_TTL_SECONDS=300
TRUSTED_PROXIES=
CHAT_STORE_ENABLED=true
CHAT_PROMPT_LOG_LEVEL=masked
STAFF_LOGIN_RATE_LIMIT_PER_IP=5
STAFF_LOGIN_RATE_LIMIT_PER_LOGIN=5
STAFF_LOGIN_RATE_LIMIT_WINDOW_SECONDS=60
STAFF_TOTP_REQUIRED=false
STAFF_TOTP_SECRET=
STAFF_PASSWORD_MIN_LENGTH=12
HEALTH_API_KEY=
VENDOR_STORAGE_QUOTA_MB=500
# ClamAV: для загрузок (прайсы, фото) нужен clamd. Установка: apt install clamav clamav-daemon (или brew install clamav + clamd).
# Запуск демона: systemctl start clamav-daemon (или clamd -c /usr/local/etc/clamd.conf).
# Для продакшена задайте: CLAMAV_SCAN_COMMAND=clamdscan
# Для локальной разработки без clamd оставьте пустым — сканирование пропускается, загрузки не отдают 503:
# CLAMAV_SCAN_COMMAND=
CLAMAV_SCAN_COMMAND=clamdscan

# Staff portal bootstrap (used by Alembic migration 008)
# Set before running `alembic upgrade head`:
# export STAFF_DEFAULT_LOGIN=superadmin
# export STAFF_DEFAULT_PASSWORD='StrongPasswordHere'

# --- Security checklist ---
# 1. Generate long secrets (at least 32 bytes) for JWT_SECRET and STAFF_JWT_SECRET:
#    openssl rand -hex 32
# 2. Ensure STAFF_JWT_SECRET != JWT_SECRET.
# 3. Set WEBHOOK_1C_API_KEY and OPENAI_API_KEY when the corresponding features are enabled.
# 4. For prod/stage runs set ENVIRONMENT=prod or ENVIRONMENT=stage (enforces strict secret validation).
