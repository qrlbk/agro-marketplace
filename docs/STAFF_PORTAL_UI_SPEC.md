# Спецификация интерфейса портала сотрудников (для дизайна в Figma)

Документ описывает, **как должен выглядеть сайт портала** и что на нём должно быть — экран за экраном. Логику (backend + frontend) реализуют отдельно; здесь только визуал и структура для макетов.

---

## 1. Общая концепция

- **Отдельный сайт** (свой домен/поддомен, например `staff.agro.kz`). Не часть маркетплейса.
- **Аудитория:** только сотрудники (поддержка, админы, супер-админ). Вход **только по логину и паролю**. Регистрации нет.
- **Интерфейс зависит от прав:** меню и страницы показываются только при наличии нужного разрешения у роли. У Support — в основном «Обращения», у Admin — почти всё, у Super Admin — плюс «Сотрудники» и «Роли».

---

## 2. Структура приложения

### 2.1. Страницы (маршруты)

| Маршрут | Название в меню | Нужное право | Описание |
|--------|------------------|--------------|----------|
| `/login` | — | — | Страница входа (логин + пароль). |
| `/` или `/dashboard` | Дашборд | `dashboard.view` | Сводка: заказы, выручка, последние заказы, заявки поставщиков, обращения. |
| `/orders` | Заказы | `orders.view` | Список заказов с фильтрами и поиском по номеру. |
| `/orders/:id` | — | `orders.view` | Карточка одного заказа (номер, статус, состав, контакты). |
| `/vendors` | Поставщики | `vendors.view` | Заявки на одобрение (список + кнопки Одобрить). |
| `/users` | Пользователи | `users.view` | Список пользователей маркетплейса (телефон, имя, роль, регион). |
| `/feedback` | Обращения | `feedback.view` | Список тикетов поддержки. |
| `/feedback/:id` | — | `feedback.view` / `feedback.edit` | Карточка обращения: текст, ответ, смена статуса, заметки. |
| `/audit` | Журнал действий | `audit.view` | Таблица событий (действие, компания, пользователь, дата). |
| `/search` | Поиск | `search.view` | Глобальный поиск (пользователи, заказы, товары, компании, обращения). |
| `/staff` | Сотрудники | `staff.manage` | Список сотрудников портала, создание/редактирование, деактивация. |
| `/roles` | Роли | `roles.manage` | Список ролей, создание/редактирование, назначение разрешений. |
| `/profile` или в шапке | Профиль / Настройки | — | Имя, логин, роль; форма «Изменить пароль». |

### 2.2. Layout (общий каркас после входа)

- **Шапка (header):**
  - Логотип или название портала (например «Портал сотрудников» / «Agro Staff»).
  - Справа: **поиск** (поле ввода + Enter → переход на `/search?q=...`). Виден только при наличии права `search.view`.
  - Справа: **профиль текущего сотрудника** — имя и/или логин, выпадающее меню: «Профиль» (смена пароля), «Выход».

- **Боковое меню (sidebar)** или верхняя навигация:
  - Пункты меню **формируются по правам**:
    - Дашборд — при `dashboard.view`
    - Заказы — при `orders.view`
    - Поставщики — при `vendors.view`
    - Пользователи — при `users.view`
    - Обращения — при `feedback.view`
    - Журнал действий — при `audit.view`
    - Поиск — при `search.view` (можно дублировать в шапке)
    - Сотрудники — при `staff.manage`
    - Роли — при `roles.manage`
  - Иконка + текст для каждого пункта. Активный пункт визуально выделен.

- **Контентная область:** основное содержимое страницы (таблицы, карточки, формы).

- **Состояния:** загрузка (скелетоны или спиннер), ошибка (красный блок с текстом), пустой список («Нет данных»).

---

## 3. Детальное описание экранов

### 3.1. Вход (Login)

- **Один экран**, без регистрации.
- Элементы:
  - Заголовок: например «Вход в портал сотрудников».
  - Поле **Логин** (текст, обязательно).
  - Поле **Пароль** (тип password, обязательно).
  - Кнопка **Войти**.
  - Сообщение об ошибке под формой (неверный логин/пароль, аккаунт деактивирован).
- После успешного входа — редирект на дашборд (или на первую доступную страницу по правам).

---

### 3.2. Дашборд

- **Заголовок:** «Дашборд».
- **Блок метрик (карточки в ряд, 3–4 штуки):**
  - Заказов (число).
  - Выручка (сумма в ₸).
  - По статусам заказов (кратко: New: 5, Paid: 3, … или компактная визуализация).
  - Опционально: количество обращений в работе, заявок поставщиков.
- **Два блока контента (сетка 2 колонки на десктопе):**
  - **Последние заказы:** таблица или список (колонки: номер заказа, покупатель/телефон, сумма, статус, дата). Строка — ссылка на карточку заказа. Ограничение, например 5–10 последних.
  - **Заявки поставщиков (ожидают одобрения):** список карточек. В каждой: название компании, БИН, телефон и имя контактного лица; кнопка **Одобрить**. Если заявок нет — текст «Нет заявок на рассмотрении».
- Права: блок «Заявки поставщиков» и кнопка «Одобрить» — при `vendors.view` / `vendors.approve`; метрики и последние заказы — при `dashboard.view` (и соответствующих правах на данные).

---

### 3.3. Заказы (список)

- **Заголовок:** «Заказы».
- **Фильтры/поиск:**
  - Поле **поиска по номеру заказа** (или общий поиск): ввод, поиск по `order_number` (например ORD-2024-000001).
  - Выпадающий список **Статус:** Все / New / Paid / Shipped / Delivered.
- **Таблица заказов:**
  - Колонки: **Номер заказа** (order_number), **Покупатель** (телефон или имя), **Поставщик** (название компании или телефон), **Сумма** (₸), **Статус**, **Дата**.
  - Строка кликабельна — переход на карточку заказа `/orders/:id`.
- Состояния: загрузка, ошибка, пустой список («Нет заказов»).

---

### 3.4. Карточка заказа

- **Хлебные крошки или ссылка:** «← К списку заказов».
- **Заголовок:** «Заказ № ORD-2024-000001» (или номер + id для совместимости).
- **Блоки информации:**
  1. **Контакты:**
     - Покупатель: телефон (кликабельная ссылка tel:), при наличии — имя.
     - Поставщик: телефон и/или название компании (кликабельно при наличии).
  2. **Детали заказа:**
     - Статус (текст или бейдж).
     - Сумма (₸).
     - Адрес доставки (если есть).
     - Комментарий к заказу (если есть).
     - Дата создания.
  3. **Состав заказа (таблица или список):**
     - Название товара, количество, цена (за единицу), сумма по строке.
     - Внизу блока — итоговая сумма.
- При наличии права `orders.edit` — возможность сменить статус (выпадающий список + кнопка «Сохранить»), если это предусмотрено бэкендом.

---

### 3.5. Поставщики

- **Заголовок:** «Заявки поставщиков (ожидают одобрения)» или «Поставщики».
- Если заявок нет: текст «Нет заявок на рассмотрении».
- Если есть — **список карточек** (или таблица). В каждой карточке:
  - Название компании (или «—»).
  - БИН.
  - Юридический адрес (если нужен в дизайне).
  - Контакт: телефон, имя пользователя.
  - Кнопка **Одобрить** (при `vendors.approve`). При нажатии — запрос на сервер, после успеха — карточка исчезает из списка.
  - Опционально: кнопка **Отклонить** (если будет в API).
- Состояния: загрузка, ошибка.

---

### 3.6. Пользователи

- **Заголовок:** «Пользователи».
- **Фильтр:** выпадающий список **Роль** — Все / guest / user / farmer / vendor / admin.
- **Таблица:** ID, Телефон, Имя, Роль, Регион, Дата регистрации (опционально). Строки только для просмотра (редактирование — если есть `users.edit` и оно реализовано в API).
- Состояния: загрузка, ошибка, пустой список.

---

### 3.7. Обращения (список)

- **Заголовок:** «Обращения в поддержку» или «Обращения».
- **Фильтр:** выпадающий список **Статус** — Все / open / in_progress / resolved.
- **Таблица:** ID, Пользователь (телефон/имя), Тема или превью текста, Статус, Дата. Строка — ссылка на карточку обращения.
- Состояния: загрузка, ошибка, пустой список.

---

### 3.8. Карточка обращения

- **Ссылка назад:** «← К списку обращений».
- **Заголовок:** «Обращение #123» (или ID).
- **Информация от пользователя:**
  - Тема (если есть).
  - Текст обращения.
  - Контактный телефон (кликабельная ссылка tel:).
  - Email (если есть).
  - Дата создания.
- **Ответ поддержки (при `feedback.edit`):**
  - Поле ввода (textarea) «Ответ пользователю» (или «Текст ответа»). Отправка ответа на email/в ЛК — на бэкенде.
  - Кнопка «Отправить ответ» или «Сохранить» (сохраняет и при необходимости отправляет).
- **Статус:** выпадающий список (open / in_progress / resolved) + кнопка сохранения (или автосохранение).
- **Заметки администратора:** текстовое поле «Внутренние заметки» (не показываются пользователю). Сохранение отдельно или вместе с ответом.
- Успешное сообщение после сохранения (например «Изменения сохранены», «Ответ отправлен»).

---

### 3.9. Журнал действий (Аудит)

- **Заголовок:** «Журнал действий» (иконка по желанию).
- **Фильтры:**
  - По компании (ID или поиск по компании).
  - По типу действия (выпадающий список: загрузка прайса, создание/изменение/удаление товара, смена статуса заказа, приглашение в команду, смена роли, удаление из команды и т.д.).
- **Таблица:** Дата и время, Действие (тип), Компания (название или ID), Пользователь (кто выполнил), Детали (опционально — JSON или краткое описание). Пагинация (страницы или «Загрузить ещё»).
- Состояния: загрузка, ошибка, пустой список.

---

### 3.10. Поиск

- **Заголовок:** «Поиск» или «Поиск: {запрос}».
- Если запрос пустой: подсказка «Введите запрос в строку поиска и нажмите Enter» (или поле поиска по центру).
- После ввода запроса — **группы результатов** (если есть данные):
  - **Пользователи:** список/таблица (телефон, имя, роль), ссылка на профиль или ID.
  - **Заказы:** номер заказа, покупатель, сумма, статус — ссылка на карточку заказа.
  - **Товары:** название, артикул, поставщик — ссылка (если есть страница товара в админке).
  - **Компании:** название, БИН — ссылка (если есть).
  - **Обращения:** ID, тема/превью, статус — ссылка на карточку обращения.
- Если ничего не найдено — текст «Ничего не найдено».
- Состояния: загрузка (индикатор при вводе/сабмите), ошибка.

---

### 3.11. Сотрудники (портал)

- **Заголовок:** «Сотрудники».
- Кнопка **«Добавить сотрудника»** (при `staff.manage`).
- **Таблица:** Логин, Имя, Роль (название роли), Активен (да/нет или галочка), Дата создания. Действия: Редактировать, Деактивировать/Активировать (в зависимости от `is_active`).
- **Модальное окно или страница «Создать сотрудника»:** Логин (обязательно), Имя, Роль (выпадающий список ролей портала), Пароль (временный, обязательный при создании), чекбокс «Активен». Кнопки «Создать» / «Отмена».
- **Модальное окно или страница «Редактировать сотрудника»:** те же поля (пароль — опционально, например «Оставить без изменений» или «Новый пароль»). Кнопки «Сохранить» / «Отмена».
- Деактивация: подтверждение «Деактивировать сотрудника? Он не сможет войти в портал.» Кнопки «Деактивировать» / «Отмена».

---

### 3.12. Роли

- **Заголовок:** «Роли».
- Кнопка **«Создать роль»** (при `roles.manage`). Системные роли (Super Admin, Admin, Support) не удаляются — в таблице либо скрыта кнопка «Удалить», либо она неактивна с подсказкой.
- **Таблица ролей:** Название, Slug, Системная (да/нет), Количество разрешений (или список кодов). Действия: Редактировать (для всех), Удалить (только для несистемных).
- **Модальное окно или страница «Создать роль»:** Название, Slug (уникальный код). Кнопка «Создать». После создания — переход к редактированию разрешений или сразу форма разрешений.
- **Модальное окно или страница «Редактировать роль»:** Название и slug (для системных — только просмотр или ограниченное редактирование). **Список разрешений:** чекбоксы по каждому разрешению (код + человекочитаемое имя), например:
  - dashboard.view — Просмотр дашборда
  - orders.view — Просмотр заказов
  - orders.edit — Редактирование заказов
  - vendors.view — Просмотр поставщиков
  - vendors.approve — Одобрение поставщиков
  - feedback.view — Просмотр обращений
  - feedback.edit — Редактирование обращений
  - users.view — Просмотр пользователей
  - users.edit — Редактирование пользователей
  - audit.view — Просмотр журнала действий
  - search.view — Глобальный поиск
  - staff.manage — Управление сотрудниками
  - roles.manage — Управление ролями
- Кнопки «Сохранить» / «Отмена». Для Super Admin можно показать «Все права» без возможности снять (или не показывать чекбоксы).

---

### 3.13. Профиль / Смена пароля

- Доступ из шапки (выпадающее меню «Профиль» или отдельная страница `/profile`).
- **Отображаемая информация:** Имя, Логин, Роль (название). Только чтение.
- **Форма «Изменить пароль»:**
  - Текущий пароль (обязательно).
  - Новый пароль (обязательно).
  - Подтверждение нового пароля (обязательно).
  - Кнопка «Изменить пароль».
  - Сообщения: успех («Пароль изменён»), ошибка (текущий неверный, пароли не совпадают и т.д.).

---

## 4. Дополнительные требования к дизайну

- **Доступность:** контраст, фокусы, подписи к полям, кнопки с понятными названиями.
- **Адаптивность:** портал чаще всего используется с десктопа, но стоит предусмотреть планшет/мобильный (меню в бургер, таблицы с горизонтальным скроллом или карточки).
- **Ошибки и границы:** при отсутствии права на страницу — 403: сообщение «Нет доступа» и кнопка «На дашборд» или автоматический редирект.
- **Выход:** кнопка «Выход» в меню профиля; после выхода — переход на `/login` и очистка токена.
- **Единый стиль:** кнопки первичные/вторичные, цвета для статусов (например open — жёлтый, in_progress — синий, resolved — зелёный), нейтральные цвета для фона и текста.

---

## 5. Сводка экранов для Figma

| № | Экран | Ключевые элементы |
|---|--------|---------------------|
| 1 | Login | Логин, пароль, «Войти», сообщение об ошибке |
| 2 | Layout | Шапка (лого, поиск, профиль), сайдбар (меню по правам), область контента |
| 3 | Дашборд | Метрики (3–4 карточки), последние заказы, заявки поставщиков |
| 4 | Заказы — список | Поиск по номеру, фильтр статуса, таблица заказов |
| 5 | Заказы — карточка | Номер, контакты, детали, состав (таблица товаров) |
| 6 | Поставщики | Список карточек заявок, кнопка «Одобрить» |
| 7 | Пользователи | Фильтр по роли, таблица пользователей |
| 8 | Обращения — список | Фильтр по статусу, таблица тикетов |
| 9 | Обращения — карточка | Текст обращения, ответ, статус, заметки |
| 10 | Журнал действий | Фильтры (компания, действие), таблица событий, пагинация |
| 11 | Поиск | Поле запроса, блоки результатов (пользователи, заказы, товары, компании, обращения) |
| 12 | Сотрудники | Таблица сотрудников, «Добавить», модалки создания/редактирования |
| 13 | Роли | Таблица ролей, «Создать роль», модалка редактирования с чекбоксами разрешений |
| 14 | Профиль | Имя, логин, роль; форма смена пароля (текущий, новый, подтверждение) |

После утверждения дизайна в Figma можно приступать к реализации логики (backend Staff/Role/Permission, защита API, затем frontend портала с привязкой к макетам).
